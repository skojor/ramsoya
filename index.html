<!doctype html>
<html lang="no">
<!--
  © 2025 Skorstad Engineering AS
  and
  Pastor S.
-->
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>Ramsøyvika – Kamera, Vær, Måne, Båter & Fly</title>
    <link rel="stylesheet" href="styles.css">

    <!-- Preconnect and DNS prefetch -->
    <link rel="preconnect" href="https://staging.skorstad.name" crossorigin>
    <link rel="preconnect" href="https://vannstand.kartverket.no">
    <link rel="preconnect" href="https://www.marinetraffic.com">
    <link rel="preconnect" href="https://www.flightradar24.com">
    <link rel="preconnect" href="https://ramsoyvika.no" crossorigin>
    <link rel="dns-prefetch" href="//staging.skorstad.name">
    <link rel="dns-prefetch" href="//vannstand.kartverket.no">
    <link rel="dns-prefetch" href="//www.marinetraffic.com">
    <link rel="dns-prefetch" href="//www.flightradar24.com">
    <link rel="dns-prefetch" href="//ramsoyvika.no">

    <!-- Load non-module dependencies that other scripts expect -->
    <script src="js/windbarb-helpers.js"></script>
</head>

<body>


<div class="page">
    <main class="stage" aria-live="polite">
        <img id="cam" alt="Siste webkamerabilde fra Ramsøy" decoding="async" loading="eager" fetchpriority="high">
        <aside class="overlay" id="weatherOverlay" hidden></aside>
        <div class="status-pill ok" id="status"><span class="dot" aria-hidden="true"></span><span id="statusText">Laster…</span>
        </div>
    </main>

    <!-- MÅNE + VARSEL PÅ SAMME LINJE -->
    <div class="astro-row">
        <section class="forecastHourly compact">
            <div class="fcH-head">
                <div>Neste 24 timer</div>
                <div class="fcH-note">Oppdateres hver 30. min</div>
            </div>
            <div class="fcH-strip" id="forecastHourly" aria-live="polite"></div>


        </section>

        <section class="moon-card" id="moonCard" aria-live="polite">
            <!-- Solar events integrated in mooncard -->
            <div class="fcH-solar" id="solarEvents" aria-live="polite">
                <div class="moon-title">Soloppgang og solnedgang</div>
                <div class="sun-events" id="nextSunEvent">
                    <div class="sun-loading">Henter soldata...</div>
                </div>
            </div>

            <div>
                <svg class="moon-svg" id="moonSvg" viewBox="0 0 120 120" role="img" aria-label="Månefase"></svg>
                <div class="moon-info">
                    <div class="moon-title">Månefase</div>
                    <div id="moonText" class="muted">Henter fra MET…</div>
                    <hr>
                    <div class="moon-title">Flo og fjære</div>
                    <div id="tide-next">
                        <div>Neste: <strong id="tideNext1">—</strong></div>
                        <div>Deretter: <strong id="tideNext2">—</strong></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ENTUR: Hurtigbåt – neste avganger -->
        <section id="entur-section" class="forecastHourly compact" aria-labelledby="entur-heading">
            <div class="fcH-head">
                <h2 id="entur-heading" style="margin:0;font-size:1.05rem;">Hurtigbåt</h2>
                <div class="fcH-note"><span id="entur-updated">oppdaterer…</span></div>
            </div>
            <div class="fcH-strip" style="display:block;padding:4px 2px;">
                <div class="fcH-card" style="width:auto;display:block;">
                    <div class="label" style="opacity:.9;margin-bottom:.25rem;">Neste avganger</div>
                    <div id="entur-next-dep" class="value"></div>
                    <!-- NB: Ikke egen actions-linje her lenger; knapper ligger per linje -->
                </div>
            </div>
        </section>
    </div>
    <!-- AIS-seksjon -->
    <section id="ais-section" aria-labelledby="ais-heading">
        <div class="ais-card">
            <header>
                <h2 id="ais-heading">Båter i nærheten</h2>
                <div class="meta"><span id="ais-count">0</span> funnet <span class="dot">•</span> <span
                        id="ais-updated">oppdaterer…</span></div>
            </header>
            <div id="ais-table-wrap">
                <table id="ais-table">
                    <thead>
                    <tr>
                        <th>Båtnavn</th>
                        <th>Hastighet (kn)</th>
                        <th>Retning</th>
                        <th>Kallesignal</th>
                        <th>Destinasjon</th>
                        <th>Avstand (nm)</th>
                        <th></th>
                    </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
            <div id="ais-empty" class="empty" hidden>Ingen fartøy å vise akkurat nå.</div>
            <div id="ais-error" class="error" hidden>Kunne ikke hente AIS-data.</div>
        </div>
    </section>

    <!-- ADS-B seksjon (NY) i samme stil som AIS) -->
    <section id="adsb-section" aria-labelledby="adsb-heading">
        <div class="ais-card">
            <header>
                <h2 id="adsb-heading">Fly i nærheten</h2>
                <div class="meta"><span id="adsb-count">0</span> funnet <span class="dot">•</span> <span
                        id="adsb-updated">oppdaterer…</span></div>
            </header>
            <div id="adsb-table-wrap">
                <table id="adsb-table">
                    <thead>
                    <tr>
                        <th>Flight</th>
                        <th>Flyselskap</th>
                        <th>Høyde (ft)</th>
                        <th>Fart (kt)</th>
                        <th>Retning</th>
                        <th>Avstand (nm)</th>
                        <th>Sist sett</th>
                    </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
            <div id="adsb-empty" class="empty" hidden>Ingen fly å vise akkurat nå.</div>
            <div id="adsb-error" class="error" hidden>Kunne ikke hente ADS-B-data.</div>
        </div>
    </section>

    <div class="box">
        <h2>Værstatistikk</h2>
        <p id="updatedTxt" style="font-size:0.9em;color:#666;margin:0 0 10px 0;">Oppdaterer...</p>
        <div style="margin-bottom:10px;">
            <button data-range="6h">6h</button>
            <button data-range="12h">12h</button>
            <button data-range="24h" class="active">24h</button>
            <button data-range="3d">3d</button>
            <button data-range="7d">7d</button>
        </div>
        <div class="chart-box">
            <canvas id="tempChart"></canvas>
        </div>
        <div class="chart-box">
            <canvas id="windChart"></canvas>
        </div>
    </div>

    <!-- Load remaining non-module scripts -->
    <script src="js/ais-manager.js"></script>
    <script src="js/adsb-manager.js"></script>
    <script src="js/tidal-manager.js"></script>
    <script src="js/entur-manager.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns@3"></script>
    <script src="js/chart-manager.js"></script>
    <script src="js/ui-manager.js"></script>

    <!-- Main ES6 module entry point -->
    <script type="module" src="js/main.js"></script>

    <div id="ais-tooltip" hidden></div>
</div>
</body>
</html>
